This chapter contains a discussion regarding the validity of the results and the
ability to use these to draw more general conclusions. Furthermore the results
and the conclusions that can be drawn from these are discussed. Finally some
suggestions for future research is given.

\section{Validity of the results}\label{sec:validity}
Two main criticisms concerning the validity of the results can be raised:
\begin{enumerate}
\item Only a few number of queries were used for evaluation;
\item And only one dataset was used for evaluation.
\end{enumerate}

Both of these criticisms will be answered in turn below. Finally a motivation
is provided as to why the results can be considered usable to draw general conclusions from.

\subsection{Only a few queries were used}
\textit{Only one single query and subsets of that query were used, this is hardly a
large set of tests for evaluation.}

To answer this criticism it is important to consider the fact that the
possibility for ambiguous indexes depends on the criteria outlined in
Section~\ref{sec:dataset}. The tables fulfilling these criteria are few, reducing
the possibility to use multiple queries as they will only involve the same
tables anyway.

Furthermore, the query constructed can be considered to be sufficiently complex
as to capture a problematic query that the problem would realistically arise
for. From this it can be said that if the problem does not arise for that query,
then it is highly unlikely that it would for any simpler query.

So while only one query and subsets of it are used, these queries cover a good
range of queries from simple to more complex for the query optimizer. This means
that the results from these can be considered valid.

\subsection{Only one dataset was used}
\textit{Only one dataset was used for evaluation, the results found for the
  problem studied could be very different for another dataset.}

This criticism is one related to the problem of evaluating databases in general:
the performance of the database is often dependent on the dataset used for
testing. While it is correct that the results could vary depending on dataset,
this problem applies to all studies of databases.

Furthermore, the dataset used to test the databases is one taken from the real
world, making it more realistic than those often otherwise used. As such, the
validity of the results of this study are well on par with those of other
studies using less realistic datasets like TPC-H.

While only one dataset is used for evaluation, the results found can be seen as
an indication of a specific behavior and should warrant future research.
Additionally, the results found are based on a dataset taken from the real
world further giving validity to the results.

\subsection{Applicability}
The results found in this study do, as all other studies of databases do, suffer
from the problem of the possibility of the results depending on the dataset
used. However, the results found in this study show indicate two things:
\begin{itemize}
\item Different access methods are used to access the same relation;
\item And the behavior of when this is done differs between MariaDB and
  PostgreSQL.\@
\end{itemize}

These results will be discussed in more detail in
Section~\ref{sec:ambigindexes}, but both of these results highlight an existing
behavior in the databases. Having more datasets to test against would not have
added anything to these findings except for an indication of how common it is
for the database's to use different access methods.

\section{Selection of access method}\label{sec:ambigindexes}
This section will discuss the main findings of the evaluation, starting with a
discussion regarding the correlation between sample size and the number of
different access methods used for the same relation. Following this a section
describing the second set of results identified: the correlation between
predicate values and access methods used.

\subsection{Sample size vs access methods used}
- index selections tend to not be ambiguous, the optimizer remains consistent
regardless of sample size used

\subsection{Predicate value vs access methods used}
One finding that is clear from the results is that the access method used often
depend on the predicate value used, rather than the statistics causing the query
optimizer to pick the incorrect one. An example of this can be seen in
Figure~\ref{fig:plot:eval1:test1} where several different access methods are
used for MariaDB depending on the predicate value used. A total of three
different access methods are used out of a total of 6 possible.

The fact that the query optimizer is sensitive to predicate value can be seen as
both intuitive and unintuitive --- the filter factor might vary considerably
between different predicate values but the same index should always be the best
for accessing the same relation.

A clear different can be seen between the two databases as PostgreSQL, while
sensitive to predicate value always selects the same access method for the
relations where MariaDB differs. Instead PostgreSQL sometimes deems all indexes
insufficient and opts instead to just do a full table scan. This is another
contrast between the two as MariaDB always picks an index if one exists, never
opting to do a full table scan.

As can be seen in Figure~\ref{fig:plot:eval2:test9} this behavior remains
consistent for both databases' query optimizers regardless of the complexity of
the query in terms of number of joins and tables involved. This indicates that
the behavior is intended, and not the cause of incorrect statistics.

\section{Future research}
This section will cover some suggestions for future research on the topic of
databases, both in general and specifically for the problem of index selection.

As discussed in Section~\ref{sec:validity} one problem when evaluating
databases is the dataset used for evaluation. In this study a dataset based on a
product for the company TriOptima was used to evaluate the databases with a real-world
dataset. However, this dataset can't be made public. Other datasets like TPC-H
or to more recently create JOB suffer from the problem that they are simpler
than a database used by a company; as an example both of them have only one
index per relation on the primary key.

One important area of research in databases would therefore be to create one or
more realistic datasets with complex data, relations and indexes that could be
used for research. Using these datasets for evaluation would then provide
results that could be considered more general and correct.

The most important results indicated by this study is that query optimizer
selects different access methods depending on the predicate values. If this
is the correct choice or not to do is not evaluated as a performance study is
beyond the scope of this thesis. A suggestion for future research would
therefore be to evaluate the performance of this behavior --- is it the right
decision to use different indexes depending on predicate values?

Finally it is important to also note that the problem of ambiguous indexes
because of small sample size, or incorrect estimation of statistics, seem to not
be common. As such, future study into the area should probably avoid this topic
in favor of other topics, for example that of optimizers being sensitive to
predicate values.